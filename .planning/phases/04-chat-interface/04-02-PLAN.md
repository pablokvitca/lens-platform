---
phase: 04-chat-interface
plan: 02
type: execute
wave: 2
depends_on: [04-01]
files_modified:
  - web_frontend/src/components/module/NarrativeChatSection.tsx
autonomous: true

must_haves:
  truths:
    - "Send button is easily tappable on mobile (44px minimum touch target)"
    - "Microphone button is easily tappable on mobile (44px minimum touch target)"
    - "Sending a message provides haptic feedback (consistent with Phase 3 interactions)"
  artifacts:
    - path: "web_frontend/src/components/module/NarrativeChatSection.tsx"
      provides: "Touch-optimized chat input buttons with haptics"
      contains: "min-h-[44px]"
  key_links:
    - from: "handleSubmit"
      to: "triggerHaptic"
      via: "function call"
      pattern: "triggerHaptic\\(10\\)"
---

<objective>
Make chat input buttons touch-friendly with 44px targets and add haptic feedback on send.

Purpose: Students can reliably tap send and microphone buttons on mobile without mis-taps, and receive tactile confirmation when sending messages.
Output: Touch-optimized input buttons with consistent haptic feedback.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/04-chat-interface/04-CONTEXT.md
@.planning/phases/04-chat-interface/04-RESEARCH.md
@.planning/phases/03-content-components/03-02-SUMMARY.md
@web_frontend/src/components/module/NarrativeChatSection.tsx
@web_frontend/src/utils/haptics.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add 44px touch targets to send and microphone buttons</name>
  <files>web_frontend/src/components/module/NarrativeChatSection.tsx</files>
  <action>
Apply 44px minimum touch targets to all chat input buttons, following the pattern established in StageProgressBar (Phase 3).

**Microphone button (line ~706-715):**
Current: `className="p-2 rounded-lg transition-colors ..."`
Change to: `className="min-w-[44px] min-h-[44px] p-2 rounded-lg transition-colors ..."`

**Stop recording button (line ~761-774):**
Current: `className="bg-gray-600 text-white px-4 py-2 rounded-lg ... min-w-[70px] ..."`
Change to: `className="bg-gray-600 text-white px-4 py-2 rounded-lg ... min-w-[70px] min-h-[44px] ..."`

**Send button (line ~777-785):**
Current: `className="bg-blue-600 text-white px-4 py-2 rounded-lg ... min-w-[70px]"`
Change to: `className="bg-blue-600 text-white px-4 py-2 rounded-lg ... min-w-[70px] min-h-[44px]"`

The 44px minimum matches iOS Human Interface Guidelines and the pattern from StageProgressBar.
  </action>
  <verify>
Run `grep -n "min-h-\[44px\]" web_frontend/src/components/module/NarrativeChatSection.tsx` - should return at least 3 matches (mic, stop, send buttons).
  </verify>
  <done>All chat input buttons have 44px minimum touch targets.</done>
</task>

<task type="auto">
  <name>Task 2: Add haptic feedback on message send</name>
  <files>web_frontend/src/components/module/NarrativeChatSection.tsx</files>
  <action>
Import the haptics utility and trigger haptic feedback when sending a message.

1. Add import at the top of the file (after other imports, around line 15):
```typescript
import { triggerHaptic } from "@/utils/haptics";
```

2. Add triggerHaptic(10) call in handleSubmit function (around line 401-411):
```typescript
const handleSubmit = (e: React.FormEvent) => {
  e.preventDefault();
  if (input.trim() && !isLoading) {
    triggerHaptic(10);  // Add this line - 10ms for subtle feedback
    // Set split point before sending - current messages become "previous"
    setCurrentExchangeStartIndex(messages.length);
    setShowScrollButton(false);
    setHasInteracted(true);
    onSendMessage(input.trim());
    setInput("");
  }
};
```

This matches the 10ms duration established in Phase 3 (03-02) for consistent tactile feedback across the app.
  </action>
  <verify>
Run `grep -n "triggerHaptic" web_frontend/src/components/module/NarrativeChatSection.tsx` - should show import and usage in handleSubmit.
Run `npm run build` in web_frontend to verify no TypeScript errors.
  </verify>
  <done>Sending messages triggers haptic feedback for tactile confirmation.</done>
</task>

</tasks>

<verification>
After all tasks:
1. `npm run lint` passes in web_frontend
2. `npm run build` passes in web_frontend
3. All input buttons have min-h-[44px] class
4. triggerHaptic imported and called in handleSubmit
</verification>

<success_criteria>
- Send button has 44px minimum height (CHAT-03)
- Microphone button has 44px minimum height (CHAT-03)
- Stop recording button has 44px minimum height (CHAT-03)
- Haptic feedback triggers on send (consistent with Phase 3)
- Build and lint pass
</success_criteria>

<output>
After completion, create `.planning/phases/04-chat-interface/04-02-SUMMARY.md`
</output>
